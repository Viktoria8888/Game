<div class="tabs">
  @for (tab of tabInfo(); track tab.category) {
  <button [class.active]="activeTab() === tab.category" (click)="switchTab(tab.category)">
    <span>{{ tab.label }}</span>
    <span class="count">{{ tab.satisfied }}/{{ tab.count }}</span>
  </button>
  }
</div>

<div class="constraints">
  @for (constraint of activeConstraints(); track constraint.title) {
  <div
    class="constraint"
    [class.satisfied]="constraint.isSatisfied"
    [class.required]="constraint.category !== 'Goal'"
    [matTooltip]="constraint.hint || ''"
    [matTooltipDisabled]="!constraint.hint"
    matTooltipPosition="above"
    matTooltipClass="tooltip"
  >
    <span class="icon">{{ getConstraintIcon(constraint) }}</span>

    <div class="content">
      <div class="title-row">
        <h4>{{ constraint.title }}</h4>

        @if (constraint.currentValue !== undefined) {
        <div class="value">
          <span>{{ constraint.currentValue }}</span>
          <span>/</span>
          <span>{{ constraint.targetValue }}</span>
        </div>
        }
      </div>

      <p>{{ constraint.description }}</p>

      @if (constraint.scoreReward || constraint.stressModifier) {
      <div class="rewards">
        @if (constraint.scoreReward) {
        <span class="reward-tag score"> ‚≠ê +{{ constraint.scoreReward }} </span>
        } @if (constraint.stressModifier) {
        <span class="reward-tag stress" [class.relief]="constraint.stressModifier < 0">
          {{ constraint.stressModifier > 0 ? 'üî•' : 'üòå' }}
          {{ constraint.stressModifier > 0 ? '+' : '' }}{{ constraint.stressModifier }}%
        </span>
        }
      </div>
      }
    </div>
  </div>
  }
</div>

@if (canPassLevel()) {
<button class="action-btn" (click)="goNextLevel()">
  All Requirements Met - Go to the next level ‚Üí
</button>
}
