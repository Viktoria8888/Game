<app-header
  [currentLevel]="currentLevel()"
  [willpowerCost]="gameService.currentSemesterOutcome().willpowerCost"
  [willpowerBudget]="gameService.currentSemesterOutcome().willpowerBudget"
  [willpowerBreakdown]="gameService.currentSemesterOutcome().costBreakdown"
  [totalScore]="this.gameService.currentSemesterOutcome().predictedTotalScore"
  [userName]="authService.username()"
  (openTutorial)="toggleTutorial(true)"
/>
<app-contraints
  [validationContext]="validationContext()"
  [validationResults]="validationResults()"
  [canPassLevel]="gameService.canPassLevel()"
  (onClickNextLevel)="handleNextLevel()"
/>

<div class="grid-courses">
  <app-schedule-grid
    [schedule]="scheduleSlots()"
    [conflictingCourseIds]="collisions()"
    [shakingIds]="shakingCourseIds()"
    [currentLevel]="gameService.currentLevel()"
  />
  <app-courses
    [availableCourses]="availableCourses()"
    [currentLevel]="gameService.currentLevel()"
    (courseConflict)="triggerConflictShake($event)"
  />
</div>

@if (showTutorial()) {
<app-tutorial (close)="toggleTutorial(false)" />
} @if (gameService.showLevelSummaryModal()) {

<app-level-summary
  [outcome]="gameService.currentSemesterOutcome()"
  [level]="gameService.currentLevel()"
  (onProceed)="proceedToNextLevel()"
  (onClose)="gameService.closeLevelSummary()"
></app-level-summary>
}
