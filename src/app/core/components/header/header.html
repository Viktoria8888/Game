<header class="game-header">
  <div class="game-title">
    <h1>âŠ¤Hâˆˆ  âˆ‘âŠ‚HâˆˆDâˆªâˆ âˆˆ  Gâˆ€Mâˆˆ</h1>
    <button
      class="help-btn"
      (click)="onHelpClick()"
      matTooltip="How to play?"
      matTooltipClass="tooltip"
    >
      ?
    </button>
  </div>

  <div class="stats-bar">
    <div class="stat-item level" [class]="levelBadgeClass()">
      <div class="stat-icon">ğŸ¯</div>
      <div class="stat-content">
        <div class="stat-label">Level</div>
        <div class="stat-value">{{ currentLevel() }}</div>
      </div>
    </div>

    <div
      class="stat-item willpower"
      [class]="willpowerState()"
      [matTooltip]="formattedBreakdown()"
      matTooltipClass="breakdown-tooltip"
      matTooltipPosition="below"
    >
      <div class="stat-icon">{{ willpowerEmoji() }}</div>
      <div class="stat-content">
        <div class="stat-label">Willpower</div>
        <div class="stat-value">
          {{ willpowerCost() }} <span class="divider">/</span> {{ willpowerBudget() }}
        </div>
      </div>
      <span class="info-icon">â“˜</span>
    </div>

    <div class="stat-item score">
      <div class="stat-icon">â­</div>
      <div class="stat-content">
        <div class="stat-label">Score</div>
        <div class="stat-value">{{ formattedScore() }}</div>
      </div>
    </div>

    <button
      class="stat-item user-account"
      (click)="isAnonymous() ? toggleLoginModal() : doLogout()"
      [matTooltip]="isAnonymous() ? 'Click to Save Progress' : 'Click to Logout'"
    >
      @if (userAvatar()) {
      <div class="user-avatar">
        <img [src]="userAvatar()" [alt]="userName()" />
      </div>
      } @else {
      <div class="user-avatar initials" [class.guest]="isAnonymous()">
        {{ userInitials() }}
      </div>
      }

      <div class="stat-content">
        <div class="stat-label">{{ isAnonymous() ? 'Guest (Unsaved)' : 'Player' }}</div>
        <div class="stat-value">{{ userName() }}</div>
      </div>

      @if (isAnonymous()) {
      <div class="warning-dot" title="Unsaved Progress">!</div>
      }
    </button>
  </div>
</header>

@if (showLogin()) {
<app-login-modal (close)="showLogin.set(false)" />
}
